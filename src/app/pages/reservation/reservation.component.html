<div class="container mt-4">
  <h3>🎟️ Réserver une séance</h3>

  <!-- Choix de la ville -->
  <div class="mb-3">
    <label for="villeSelect" class="form-label">Choisissez une ville :</label>
    <select id="villeSelect" class="form-select" [(ngModel)]="selectedVille" (change)="filtrerFilmsParVille(); afficherSeances()">
      <option [ngValue]="''" disabled>-- Sélectionner une ville --</option>
      <option *ngFor="let ville of cinemas" [ngValue]="ville">{{ ville }}</option>
    </select>
  </div>

  <!-- Choix du film -->
  <div class="mb-3">
    <label for="filmSelect" class="form-label">Choisissez un film :</label>
    <select id="filmSelect" class="form-select" [(ngModel)]="selectedFilmId" (change)="afficherSeances()">
      <option [ngValue]="null" disabled>-- Sélectionner un film --</option>
      <option *ngFor="let f of filmsFiltres" [ngValue]="f._id">{{ f.titre }}</option>
    </select>
  </div>

  <!-- Liste des séances filtrées -->
  <div *ngIf="seancesFiltrees.length > 0">
    <h5 class="mt-4">Séances disponibles :</h5>
    <ul class="list-group mb-4">
      <li *ngFor="let s of seancesFiltrees"
          class="list-group-item d-flex justify-content-between align-items-center"
          [class.active]="seanceSelectionnee === s"
          (click)="selectionnerSeance(s)">
        <div>
          📅 {{ s.jour }} - 🕒 {{ s.debut }} à {{ s.fin }} - 🎬 {{ s.qualite }} - 💶 {{ s.prix }} € - 🎫 {{ s.placesDisponibles }} places
        </div>
      </li>
    </ul>
  </div>

  <!-- Formulaire de réservation -->
  <div *ngIf="seanceSelectionnee">
    <h5 class="mt-4">🎯 Réserver la séance sélectionnée</h5>
    <form (ngSubmit)="validerReservation()">
      <div class="mb-3">
        <label for="nbPlaces" class="form-label">Nombre de places :</label>
        <input
          type="number"
          id="nbPlaces"
          class="form-control"
          [(ngModel)]="nbPlaces"
          name="nbPlaces"
          min="1"
          [max]="seanceSelectionnee.placesDisponibles"
          required
        />
      </div>
      <button type="submit" class="btn btn-primary">✅ Réserver</button>
    </form>
  </div>
</div>
